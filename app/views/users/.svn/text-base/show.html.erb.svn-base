<% unless @recipes.blank? and current_user == @user %>
  <div id="user-<%= @user.id %>" class="vcard">
    <%= link_to "#{image_tag @user.avatar.url(:large), :class => "avatar", :alt => ""}", @user %>
    <h1>
      <%= link_to "recetas de #{@user.name}", @user %>
      <% if @category.nil? %>
        <span class="counter">(<%= @total_recipes %>)</span>
      <% else %>
        <span class="ft">de</span> <%= link_to @category.name, @category %>
        <span class="counter">(<%= Category.count(:joins => :recipes, 
            :conditions => { :id => @category.id,
            :recipes => { :author_id => @user.id }
          }) %>)</span>
      <% end %>
    </h1>
    <% if current_user == @user %>
      <p><%= link_to 'crear una receta nueva', new_user_recipe_path(current_user) %></p>
    <% end %>

  </div>

  <div class="sidebar sidebar-users">
    <%= render :partial => "sidebar" %>
  </div>
<% end %>

<div class="main">

  <% if @recipes.blank? %>
    
    <% if current_user.nil? or @user != current_user %>
      <div class="msg blank">
        <h2><%= @user.name %> todavía no tiene ninguna receta</h2>
        <p>puedes <%= link_to "explorar más recetas", recipes_path %> o buscar <%= link_to "recetas por categorias", categories_path %>.</p>
      </div>
    <% else %>
      <div class="msg welcome">
        <h1>¡Bienvenido a rezets.com!</h1>
        <p>Si estás aquí es porque eres uno de los afortunados que han recibido una invitación para disfrutar de este nuevo servicio.</p>
        <p>Como verás todavía andamos en paños menores así que te rogaría que si vieras alguna cosilla que no funciona o algo no te gusta nos lo hicieras saber.</p>
        <p>Para comenzar a disfrutar de rezets.com sólo tienes que <%= link_to "crear una receta", new_recipe_path %>.</p>
        <p>¡Gracias!</p>
      </div>
    <% end %>

  <% else %>

    <ul class="recipes">
      <% @recipes.each do |recipe| %>
        <%= render :partial => "recipes/recipe", :locals => {:recipe => recipe} %>
      <% end %>
    </ul>

    <%= will_paginate @recipes %>

    <% if @user == current_user %>
      <% if @category.nil? %>
        <p><%= link_to "suscribirse a tus propias recetas", user_path(@user, :format => :rss), :class => "feed-link" %></p>
      <% else %>
        <p><%= link_to "suscribirse a tus propias recetas de #{@category.name}", category_user_path(@category, @user, :format => :rss), :class => "feed-link" %></p>
      <% end %>
    <% else %>
      <% if @category.nil? %>
        <p><%= link_to "suscribirse a las recetas de #{@user.name}", user_path(@user, :format => :rss), :class => "feed-link" %></p>
      <% else %>
        <p><%= link_to "suscribirse a las recetas de #{@user.name} de #{@category.name}", category_user_path(@category, @user, :format => :rss), :class => "feed-link" %></p>
      <% end %>
    <% end %>

  <% end %>

</div>
